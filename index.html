<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Красивые телефонные номера</title>

<style>
body {
    margin: 0;
    font-family: system-ui, Arial, sans-serif;
    background: #0f172a;
    color: #e5e7eb;
    padding: 16px;
}
.container {
    max-width: 900px;
    margin: auto;
}
h1 {
    text-align: center;
    color: #38bdf8;
}
.card {
    background: #020617;
    border-radius: 14px;
    padding: 16px;
    margin-top: 16px;
}
textarea {
    width: 100%;
    height: 140px;
    background: #020617;
    color: #e5e7eb;
    border: 1px solid #334155;
    border-radius: 10px;
    padding: 12px;
    font-size: 16px;
}
button {
    width: 100%;
    padding: 14px;
    margin-top: 12px;
    border: none;
    border-radius: 10px;
    background: #38bdf8;
    color: #020617;
    font-size: 16px;
    font-weight: bold;
    cursor: pointer;
}
.number {
    background: #020617;
    padding: 12px;
    border-radius: 10px;
    margin-top: 8px;
    display: flex;
    justify-content: space-between;
    align-items: center;
}
.price {
    color: #4ade80;
    font-weight: bold;
}
.highlight span {
    color: #facc15;
    font-weight: bold;
}
</style>
</head>

<body>
<div class="container">
<h1>Красивые телефонные номера</h1>

<div class="card">
<textarea id="input" placeholder="
+7 (999) 000-00-00
8-999-888-77-66
79991222112
"></textarea>
<button id="analyzeBtn">Анализировать</button>
</div>

<div class="card" id="output">
<p>Результаты появятся здесь</p>
</div>
</div>

<script>
document.getElementById("analyzeBtn").addEventListener("click", analyze);

function analyze() {
    const text = document.getElementById("input").value;

    // убираем всё кроме цифр и +
    const cleaned = text.replace(/[^\d+]/g, " ");

    // ищем телефонные номера
    const matches = cleaned.match(/(\+7|7|8)?\d{10}/g);

    if (!matches) {
        document.getElementById("output").innerHTML =
            "<p>Телефонные номера не найдены</p>";
        return;
    }

    const phones = matches.map(normalize);
    const countMap = {};

    phones.forEach(p => countMap[p] = (countMap[p] || 0) + 1);

    let html = "<h2>Найденные красивые номера</h2>";

    phones.forEach(num => {
        if (isBeautiful(num)) {
            const price = estimatePrice(num, countMap[num]);
            html += `
            <div class="number">
                <div class="highlight">${highlight(num)}</div>
                <div class="price">${price.toLocaleString()} ₽</div>
            </div>`;
        }
    });

    document.getElementById("output").innerHTML = html;
}

function normalize(n) {
    n = n.replace(/\D/g, "");
    if (n.length === 10) n = "7" + n;
    if (n.startsWith("8")) n = "7" + n.slice(1);
    return "+".concat(n);
}

function isBeautiful(num) {
    const n = num.slice(2);

    if (/^(\d)\1+$/.test(n)) return true;      // все одинаковые
    if (/(\d)\1{3}$/.test(n)) return true;     // 0000 в конце
    if (n === n.split("").reverse().join("")) return true; // палиндром
    if ("0123456789".includes(n.slice(-4))) return true;   // 1234

    return false;
}

function estimatePrice(num, count) {
    const n = num.slice(2);
    let price = 3000;

    if (/^(\d)\1+$/.test(n)) price += 30000;
    if (/(\d)\1{3}$/.test(n)) price += 20000;
    if (n === n.split("").reverse().join("")) price += 12000;
    if ("0123456789".includes(n.slice(-4))) price += 7000;
    if (count > 1) price += 2000;

    return price;
}

function highlight(num) {
    const n = num.slice(2);
    const freq = {};

    n.split("").forEach(d => freq[d] = (freq[d] || 0) + 1);

    return "+7" + n.split("").map(d =>
        freq[d] > 1 ? `<span>${d}</span>` : d
    ).join("");
}
</script>

</body>
</html>
